{% extends 'src/dashboard/basic.html' %}
{% load static %}
<title>{% block title %}Market {% endblock %}</title>
{% block css_page %}
<link href="{% static 'assets/media/images/icons/logo.svg' %}" rel="shortcut icon" type="image/x-icon" />

<!-- Start::Global Styles (used by all pages) -->
<link href="{% static 'assets/css/styles.bundle.css' %}" rel="stylesheet" type="text/css" />
<!-- End::Global Styles -->
<!-- Start::Plugins (used by this page) -->
<link href="{% static 'assets/plugins/apexcharts/apexcharts.css' %}" rel="stylesheet" type="text/css" />
<!-- End::Plugins -->
<!-- Start::Page Styles (used by this page) -->
<link href="{% static 'assets/css/pages/wallet-v1.css' %}" rel="stylesheet" type="text/css" />
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<!-- End::Page Styles -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
{% endblock %}
</head>

{% block content %}
<div class="container my-5" style="width: 70%; margin: auto;">
    <h1 class="component__title mb-4 text-center">Confirm Investing In <span id="plan-name">{{ plan.name }}</span></h1>

    {% if messages %}
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
        <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto">Alert</strong>
                <small class="text-muted">Just now</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                {% for message in messages %}
                {{ message }}
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <div class="card text-center shadow ">
        <div class="card-header bg-primary text-white">
            Investment Plan: {{ plan.name }}
        </div>
        <div class="card-body bg-dark text-white">
            <h5 class="card-title">{{ plan.description }}</h5>
            <p class="card-text"><strong>Daily Interest Rate:</strong> {{ plan.daily_interest_rate }}%</p>
            <p class="card-text"><strong>Duration:</strong> {{ plan.cycle_days }} Days</p>
            <p class="card-text"><strong>Price:</strong> {{ plan.price }} KSH</p>
            <p class="card-text"><strong>Your Wallet Balance:</strong> {{ wallet.balance }} KSH</p>
            <form method="post" action="{% url 'confirm_investment' plan.id %}">
                {% csrf_token %}
                <div class="d-flex justify-content-center gap-2 mt-2 pages-items__language">
                    <a href="{% url 'market' %}" class="btn btn-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary">Confirm Investment</button>
                </div>
            </form>
        </div>
        <div class=" bg-dark text-body-secondary">
            Review your investment details before confirming.
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const toastEl = document.getElementById('liveToast');
            const toast = new bootstrap.Toast(toastEl);
            toast.show();
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    {% endblock %}